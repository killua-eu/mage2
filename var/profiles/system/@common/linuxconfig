#######################
### Mage - common 
#######################

# Defaults

CONFIG_GENTOO_LINUX_INIT_SYSTEMD=y
CONFIG_BSD_PROCESS_ACCT_V3=y
CONFIG_CC_STACKPROTECTOR_STRONG=y
CONFIG_IKCONFIG=y
CONFIG_IKCONFIG_PROC=y
CONFIG_BLK_DEV_INTEGRITY=y
CONFIG_KSM=y
CONFIG_CLEANCACHE=y
CONFIG_FRONTSWAP=y
CONFIG_MTRR_SANITIZER=y
CONFIG_EFI_STUB=y
CONFIG_ZPOOL=m
CONFIG_USB_PRINTER=n

# Networking

CONFIG_MAC80211_RC_MINSTREL_VHT=y
CONFIG_GENEVE=y
CONFIG_NVM=y
CONFIG_PACKET_DIAG=y
CONFIG_UNIX_DIAG=y
CONFIG_BRIDGE=m
CONFIG_VLAN_8021Q=m
CONFIG_BRIDGE_VLAN_FILTERING=y
CONFIG_VLAN_8021Q_MVRP=y
CONFIG_INET_AH=y
CONFIG_INET_ESP=y
CONFIG_INET_IPCOMP=y
CONFIG_INET_XFRM_MODE_TRANSPORT=y
CONFIG_INET_XFRM_MODE_TUNNEL=y
CONFIG_INET_XFRM_MODE_BEET=y
CONFIG_INET_DIAG=y
CONFIG_INET_UDP_DIAG=y
CONFIG_NETFILTER_ADVANCED=y
CONFIG_NETFILTER_XT_MATCH_ADDRTYPE=y
CONFIG_NETFILTER_XT_MATCH_CONNTRACK=y
CONFIG_NETFILTER_XT_MATCH_COMMENT=y
CONFIG_NETFILTER_XT_MATCH_MULTIPORT=y
CONFIG_OPENVSWITCH=y
CONFIG_VSOCKETS=m
CONFIG_NETLINK_DIAG=y
CONFIG_BPF_JIT=y
CONFIG_BLK_DEV_NBD=m
CONFIG_CDROM_PKTCDVD=m
CONFIG_ATA_OVER_ETH=m
CONFIG_MD=y
CONFIG_MD_RAID0=y
CONFIG_MD_RAID1=y
CONFIG_MD_RAID10=y
CONFIG_MD_RAID456=y
CONFIG_BLK_DEV_DM=y
CONFIG_DM_RAID=y
CONFIG_BONDING=m
CONFIG_IFB=m
CONFIG_NET_TEAM=m
CONFIG_MACVLAN=m
CONFIG_MACVTAP=m
CONFIG_IPVLAN=m
CONFIG_VXLAN=m
CONFIG_TUN=m
CONFIG_VETH=m
CONFIG_PPP=m
CONFIG_PPP_BSDCOMP=m
CONFIG_PPP_DEFLATE=m
CONFIG_PPP_MULTILINK=y
CONFIG_PPPOE=m
CONFIG_PPP_ASYNC=m
CONFIG_I2C_CHARDEV=m
CONFIG_I2C_MUX=m
CONFIG_IPMI_HANDLER=m
CONFIG_IPMI_DEVICE_INTERFACE=m
CONFIG_IPMI_SI=m
CONFIG_EDAC_MM_EDAC=y
CONFIG_EXT4_ENCRYPTION=y
CONFIG_BTRFS_FS=y
CONFIG_BTRFS_FS_POSIX_ACL=y
CONFIG_FUSE_FS=y
CONFIG_CUSE=y
CONFIG_OVERLAY_FS=y
CONFIG_FSCACHE=y
CONFIG_UDF_FS=y
CONFIG_NTFS_FS=y
CONFIG_NTFS_RW=y
CONFIG_ECRYPT_FS=y
CONFIG_ECRYPT_FS_MESSAGING=y
CONFIG_SQUASHFS=y
CONFIG_CIFS=y
CONFIG_CIFS_XATTR=y
CONFIG_CIFS_ACL=y
CONFIG_CIFS_POSIX=y
CONFIG_LATENCYTOP=y
CONFIG_KVM=m
CONFIG_KVM_INTEL=m
CONFIG_KVM_AMD=m
CONFIG_VHOST_NET=m

# Virtualization

CONFIG_MEMCG=y
CONFIG_BLK_CGROUP=y
CONFIG_CFQ_GROUP_IOSCHED=y
CONFIG_CGROUP_PIDS=y
CONFIG_BLK_DEV_THROTTLING=y
CONFIG_DEVPTS_MULTIPLE_INSTANCES=y
CONFIG_VIRT_DRIVERS=y
CONFIG_VIRTIO_PCI=m
CONFIG_VIRTIO_BALLOON=m
CONFIG_VIRTIO_INPUT=m
CONFIG_HW_RANDOM_VIRTIO=m
CONFIG_VIRTIO_MMIO=m
CONFIG_VIRTIO_INPUT=m
CONFIG_VIRTIO_CONSOLE=m
CONFIG_VIRTIO_NET=m
CONFIG_SCSI_VIRTIO=m
CONFIG_VIRTIO_BLK=m
CONFIG_ATA_OVER_ETH=m

#######################
### Machine specific
#######################

CONFIG_DEFAULT_HOSTNAME=$hostname
 
#######################
### Package reuqirements
#######################

CONFIG_BLK_DEV_INITRD=Y             # sys-kernel/dracut-043
CONFIG_DEVTMPFS=Y                   # sys-kernel/dracut-043
CONFIG_AUTOFS4_FS=Y                 # sys-apps/systemd-218
CONFIG_DEVPTS_MULTIPLE_INSTANCES=y  # sys-apps/systemd-218
CONFIG_CGROUPS=y       # systemd-226-r2
CONFIG_BLK_DEV_BSG=y
CONFIG_FANOTIFY=Y                   # sys-apps/systemd-218
CONFIG_FW_LOADER_USER_HELPER=N      # sys-apps/systemd-218
CONFIG_GRKERNSEC_PROC=N             # sys-apps/systemd-218
CONFIG_GENTOO_LINUX_INIT_SYSTEMD=Y  # sys-apps/systemd
CONFIG_UEVENT_HELPER_PATH=""        # sys-apps/systemd
CONFIG_MEMCG_SWAP=y		    # app-emulation/libvirt
CONFIG_TMPFS_XATTR=y       # systemd-226-r2
CONFIG_DMIID=y       # systemd-226-r2
CONFIG_EPOLL=y       # systemd-226-r2
CONFIG_FHANDLE=y       # systemd-226-r2
CONFIG_INOTIFY_USER=y       # systemd-226-r2
CONFIG_IPV6=y       # systemd-226-r2
CONFIG_NET=y       # systemd-226-r2
CONFIG_PROC_FS=y       # systemd-226-r2
CONFIG_SECCOMP=y       # systemd-226-r2
CONFIG_SIGNALFD=y       # systemd-226-r2
CONFIG_SYSFS=y       # systemd-226-r2
CONFIG_TIMERFD=y       # systemd-226-r2
CONFIG_UNIX=y       # systemd-226-r2
CONFIG_TMPFS_POSIX_ACL=y       # systemd-226-r2
CONFIG_HIGH_RES_TIMERS=y # pulseaudio


CONFIG_NF_NAT_IPV6=y		    # lxc
CONFIG_IP6_NF_NAT=y		    # lxc
CONFIG_IP6_NF_TARGET_MASQUERADE=y   # lxc
CONFIG_DEVPTS_MULTIPLE_INSTANCES=y  # lxc

# LXC according to http://www.funtoo.org/Linux_Containers
CONFIG_UTS_NS=y
CONFIG_IPC_NS=y
CONFIG_PID_NS=y
CONFIG_NET_NS=y
CONFIG_USER_NS=y

CONFIG_CGROUP_DEVICE=y
CONFIG_CGROUP_SCHED=y
CONFIG_CGROUP_CPUACCT=y
CONFIG_CGROUP_FREEZER=y
CONFIG_CGROUP_CPUACCT
CONFIG_MEMCG=y
CONFIG_MEMCG_SWAP=y
CONFIG_MEMCG_SWAP_ENABLED=n # Memory Resource Controller Swap Extension (CONFIG_MEMCG_SWAP=y) comes with its price in a bigger memory consumption! Read description for more
CONFIG_CPUSETS=y

CONFIG_BRIDGE_IGMP_SNOOPING=y
CONFIG_BRIDGE_VLAN_FILTERING=y
CONFIG_BRIDGE_NETFILTER=m
CONFIG_EXPERT=y
CONFIG_CHECKPOINT_RESTORE=y # visible in nconfig only if CONFIG_EXPERT=y